SELECT
	Userinfo.UserId,
	Userinfo.Consecutivo,
	Userinfo.Name,
	Checkinout.CheckTime,
	INT(Checkinout.CheckTime) AS Fecha,
	( 
		Checkinout.CheckTime - INT(Checkinout.CheckTime)
	) AS Hora,
	Checkinout.CheckTime as llegada,
	TbTurnos.Entra,
	TbDias.NomDia,
	(
		( 
			Checkinout.CheckTime - INT(Checkinout.CheckTime) 
		) - TbTurnos.Entra
	) AS Retardo 
FROM Userinfo 
	INNER JOIN 
	(
		TbTurnos 
		INNER JOIN 
		(
			TbJornadaTurno 
			INNER JOIN 
			(
				TbDias 
				INNER JOIN 
				(
					Checkinout INNER JOIN 
					TbDiaJornadaTurno ON Checkinout.IdDjT = TbDiaJornadaTurno.IdDjT
				) ON TbDias.IdDia = TbDiaJornadaTurno.IdDia
			) ON TbJornadaTurno.IdJt = TbDiaJornadaTurno.IdJt
		) ON TbTurnos.Idturno = TbJornadaTurno.Idturno
	) ON Userinfo.Userid = Checkinout.Userid 
WHERE Checkinout.CheckType='E' AND 
	(
		(
			(
				Checkinout.CheckTime - INT(Checkinout.CheckTime)
			) - TbTurnos.Entra
		)
	) > 0.00417 
	AND Userinfo.Name<>'0' 
	AND YEAR(Checkinout.CheckTime)='2023' 
	AND MONTH(Checkinout.CheckTime)=03;